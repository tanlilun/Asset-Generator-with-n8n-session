<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Social Media Post Comparison</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
        }
        
        .s2-container {
            display: flex;
            flex-wrap: wrap;
            justify-content: center;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .s2-social-post {
            background-color: #fff;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            overflow: hidden;
            width: 100%;
            max-width: 400px;
            margin-bottom: 20px;
        }

        .s2-header {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            margin-bottom: 8px;
            font-size: 18px;
            margin: 10px auto;
            padding: 8px 16px;
            background-color: white;
            color: black;
            text-align: center;
            text-decoration: none;
            border-radius: 6px;
            font-weight: bold;
            width: fit-content;
        }
        
        /* Common Post Styles */
        .s2-post-header {
            display: flex;
            align-items: center;
            padding: 12px;
        }
        
        .s2-profile-pic {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            margin-right: 8px;
            object-fit: cover;
        }
        
        .s2-user-info {
            flex-grow: 1;
        }
        
        .s2-username {
            font-weight: 600;
            font-size: 15px;
            color: #050505;
        }
        
        .s2-post-time {
            font-size: 13px;
            color: #65676B;
        }
        
        .s2-post-content {
            padding: 0 12px 12px;
            font-size: 15px;
            line-height: 1.4;
        }
        
        .s2-post-image {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
        }
        
        .s2-post-actions {
            display: flex;
            padding: 8px 12px;
            font-size: 15px;
            font-weight: 600;
        }
        
        .s2-action {
            display: flex;
            align-items: center;
            margin-right: 16px;
        }
        
        .s2-action svg {
            margin-right: 6px;
        }
        
        .s2-likes-comments {
            padding: 10px 12px;
            font-size: 15px;
        }
        
        
        /* LinkedIn Specific */
        .s2-email-post {
            border: 1px solid #e0e0e0;
        }
        
        .s2-email-post .post-header {
            border-bottom: 1px solid #e0e0e0;
        }
        
        .s2-email-post .post-content {
            color: #000000;
        }
        
        .s2-email-post .likes-comments {
            color: #666666;
            border-top: 1px solid #e0e0e0;
        }
        
        .s2-email-post .post-actions {
            border-top: 1px solid #e0e0e0;
            color: #666666;
            justify-content: space-around;
        }
        .s2-email-container {
            max-width: 600px;
            margin: 0 auto;
            text-align: center;
            padding: 20px;
        }
        
        /* Responsive Adjustments */
        @media (max-width: 900px) {
            .s2-container {
                flex-direction: column;
                align-items: center;
            }
            .s2-social-post {
                max-width: 400px;
            }
        }
        .s2-email-full {
            flex: 1 1 100%;
            width: 100%;
            max-width: 100%;
            padding: 0 12px;
        }

        /* When it wraps to the next row and has enough screen space */
        @media (min-width: 1280px) {
            .s2-container {
                align-items: flex-start;
            }
            .s2-email-full {
                max-width: 1250px;
            }
        }

        @media (min-width: 600px) {
            .s2-email-full {
                max-width: 90%;
            }
        }

        @media (min-width: 900px) {
            .s2-email-full {
                max-width: 700px;
            }
        }

        @media (min-width: 1100px) {
            .s2-email-full {
                max-width: 1100px;
            }
        }

        .loader-wrapper {
            display: flex;
            justify-content: center;
        }
        .loader {
            border: 8px solid #f3f3f3;
            border-top: 8px solid #007bff;
            border-radius: 50%;
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .message {
            text-align: center;
            font-size: 18px;
            margin-bottom: 30px;
        }
        .hidden {
            display: none;
        }

    </style>
</head>
<body>
    <div class="s2-container">
        <!-- Email Post -->
        <div class="s2-email-full">
            <h3 class="s2-header">
                <svg width="20" height="20" fill="#EA4335" viewBox="0 0 24 24">
                    <path d="M12 13.065L0 6.25V18a2 2 0 002 2h20a2 2 0 002-2V6.25l-12 6.815zM12 11L0 4h24L12 11z"/>
                </svg>
                Email Newsletter
            </h3>
            <div class="s2-social-post s2-email-post s2-email-full" style="padding-bottom: 12px;">
                <!-- Subject & Icons -->
                <div style="display: flex; justify-content: space-between; align-items: center; padding: 12px 12px 0;">
                    <div id="subject-section" class="hidden"></div>
                    <div id="subject-loading-section" class="" style="width:100%;max-width:600px;">
                        <div class="loader-wrapper">
                            <div class="loader"></div>
                        </div>
                        <div class="message">Loading Subject... please wait</div>
                    </div>

                    <div style="display: flex; gap: 12px; align-items: center; color: #5f6368; font-size: 16px;">
                        <span style="font-size: 13px;">Fri 4 Jul, 11:16 (Just Now)</span>
                        <span style="cursor: pointer;">‚≠ê</span>
                        <span style="cursor: pointer;">üòä</span>
                        <span style="cursor: pointer;">‚Ü©</span>
                        <span style="cursor: pointer;">‚ãÆ</span>
                    </div>
                </div>

                <!-- Sender -->
                <div class="s2-post-header" style="border: none; padding-top: 4px;">
                    <img src="https://ladiesstyleclothes.wordpress.com/wp-content/uploads/2015/12/cimb-logo.png" alt="Profile" class="s2-profile-pic">
                    <div class="s2-user-info">
                        <div class="s2-username">CIMB</div>
                        <div class="s2-post-time" style="color: #5f6368;">to me</div>
                    </div>
                </div>

                <div class="s2-email-container">
                    <!-- Email Content -->
                    <div class="s2-post-content" style="padding-top: 12px; font-size: 14px; color: #202124;">
                        <div id="headline-1-loading-section" class="" style="width:100%;max-width:600px;">
                            <div class="loader-wrapper">
                                <div class="loader"></div>
                            </div>
                            <div class="message">Loading Headline... please wait</div>
                        </div>
                        <div id="headline-1-section" class="hidden"></div>
                        
                        <div id="image-loading-section" style="width:100%;max-width:600px;">
                            <div class="loader-wrapper">
                                <div class="loader"></div>
                            </div>
                            <div class="message">Loading Image... please wait</div>
                        </div>
                        <div id="image-section" class="hidden"></div>
                        
                        <div id="headline-2-loading-section" style="width:100%;max-width:600px;">
                            <div class="loader-wrapper">
                                <div class="loader"></div>
                            </div>
                            <div class="message">Loading Headline... please wait</div>
                        </div>
                        <div id="headline-2-section" class="hidden"></div>
                        
                        <div id="description-loading-section" style="width:100%;max-width:600px;">
                            <div class="loader-wrapper">
                                <div class="loader"></div>
                            </div>
                            <div class="message">Loading Description... please wait</div>
                        </div>
                        <div id="description-section" class="hidden"></div>
                        
                        <div id="caption-loading-section" style="width:100%;max-width:600px;">
                            <div class="loader-wrapper">
                                <div class="loader"></div>
                            </div>
                            <div class="message">Loading Caption... please wait</div>
                        </div>
                        <div id="caption-section" class="hidden"></div>
                        <br></br>

                        <div id="cta-loading-section" style="width:100%;max-width:600px;">
                            <div class="loader-wrapper">
                                <div class="loader"></div>
                            </div>
                            <div class="message">Loading CTA... please wait</div>
                        </div>
                        <div id="cta-section" class="hidden"></div>
                    </div>
                </div>
                <!-- Footer -->
                <div class="s2-post-content" style="padding-top: 20px; color: #5f6368; font-size: 12px; border-top: 1px solid #e0e0e0;">
                    <p>This email was sent automatically generated by Gen AI Demo<br>
                </div>

                <!-- Reply/Forward Buttons -->
                <div style="display: flex; gap: 10px; padding: 12px; padding-top: 16px;">
                    <button style="padding: 6px 14px; border: 1px solid #dadce0; border-radius: 8px; background-color: white; cursor: pointer; font-size: 13px; color: #202124;">‚Ü© Reply</button>
                    <button style="padding: 6px 14px; border: 1px solid #dadce0; border-radius: 8px; background-color: white; cursor: pointer; font-size: 13px; color: #202124;">‚§¥ Forward</button>
                    <button style="padding: 6px 14px; border: 1px solid #dadce0; border-radius: 8px; background-color: white; cursor: pointer; font-size: 13px; color: #202124;">üòä Emoji</button>
                </div>
            </div>
        </div>
    </div>
    <script type="module">
        const subjectSection = document.getElementById('subject-section');
        const headline1Section = document.getElementById('headline-1-section');
        const headline2Section = document.getElementById('headline-2-section');
        const descriptionSection = document.getElementById('description-section');
        const captionSection = document.getElementById('caption-section');
        const ctaSection = document.getElementById('cta-section');
        const subjectLoadingSection = document.getElementById('subject-loading-section');
        const headline1LoadingSection = document.getElementById('headline-1-loading-section');
        const headline2LoadingSection = document.getElementById('headline-2-loading-section');
        const descriptionLoadingSection = document.getElementById('description-loading-section');
        const captionLoadingSection = document.getElementById('caption-loading-section');
        const ctaLoadingSection = document.getElementById('cta-loading-section');

        const imageSection = document.getElementById('image-section');
        const imageLoadingSection = document.getElementById('image-loading-section');

        const loaded = {
            emailItems: false,
            images: false
        };

        async function pollStatus() {
            let needsRetry = false;

            const requests = [];

            if (!loaded.emailItems) requests.push(fetch('/api/email-items'));
            if (!loaded.images) requests.push(fetch('/api/images'));
            
            const responses = await Promise.all(requests);
            const data = await Promise.all(responses.map(res => res.json()));

            let i = 0;

            if (!loaded.emailItems) {
                const data1 = data[i++];
                if (data1.length > 0) {
                    const emailItem = data1[0];
                    subjectSection.innerHTML = `
                        <div style="font-size: 16px; font-weight: 500; color: #202124;">${emailItem.subject}</div>
                    `;
                    headline1Section.innerHTML = `
                        <h2>${emailItem.headline}</h2>
                    `;
                    headline2Section.innerHTML = `
                        <p>${emailItem.headline}</p>
                    `;
                    descriptionSection.innerHTML = `
                        <p>${emailItem.description}</p>
                    `;
                    captionSection.innerHTML = `
                        <p>${emailItem.caption}</p>
                    `;
                    ctaSection.innerHTML = `
                        <a href="https://www.yourbank.com/apply" style="background:#007bff;color:#fff;padding:10px 15px;text-decoration:none;border-radius:5px;">${emailItem.cta}</a>
                    `;
                    subjectSection.classList.remove('hidden');
                    headline1Section.classList.remove('hidden');
                    headline2Section.classList.remove('hidden');
                    descriptionSection.classList.remove('hidden');
                    captionSection.classList.remove('hidden');
                    ctaSection.classList.remove('hidden');
                    subjectLoadingSection.classList.add('hidden');
                    headline1LoadingSection.classList.add('hidden');
                    headline2LoadingSection.classList.add('hidden');
                    descriptionLoadingSection.classList.add('hidden');
                    captionLoadingSection.classList.add('hidden');
                    ctaLoadingSection.classList.add('hidden');
                    loaded.emailItems = true;
                } else {
                needsRetry = true;
                }
            }

            if (!loaded.images) {
                const data2 = data[i++];
                if (data2.length > 0) {
                    const image = data2[0];
                    imageSection.innerHTML = `
                        <img src="${image.image_url}" alt="Banner" style="width:100%;max-width:600px;">
                    `;
                    imageSection.classList.remove('hidden');
                    imageLoadingSection.classList.add('hidden');
                    loaded.images = true;
                } else {
                needsRetry = true;
                }
            }
            
            if (needsRetry) {
                setTimeout(pollStatus, 2000);
            }
        }

        pollStatus();

    </script>
</body>
</html>